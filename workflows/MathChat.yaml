kind: AdaptiveDialog
beginDialog:

  kind: OnActivity
  id: workflow_demo
  actions:

    - kind: SetVariable
      id: set_project
      variable: Topic.Project
      value: =System.LastMessage.Text

    - kind: AnswerQuestionWithAI
      id: question_student
      userInput: =Topic.Project
      additionalInstructions: asst_jCrWfBd1XrfVXMtpbfyVoIHC

    - kind: ResetVariable
      id: reset_project
      variable: Topic.Project

    - kind: AnswerQuestionWithAI
      id: question_teacher
      userInput: =""
      additionalInstructions: asst_aArB2g4tFWOTcgmUua062wjM

    - kind: SetVariable
      id: set_count_increment
      variable: Topic.TurnCount
      value: =Topic.TurnCount + 1

    - kind: ConditionGroup
      id: check_completion
      conditions:

        - condition: =!IsBlank(Find("congratulations", Lower(System.LastMessage.Text)))
          id: check_turn_done
          actions:

            - kind: SendActivity
              id: sendActivity_done
              activity: GOLD STAR!
    
        - condition: =Topic.TurnCount < 4
          id: check_turn_count
          actions:
    
            - kind: GotoAction
              id: goto_student_agent
              actionId: question_student

      elseActions:
    
        - kind: SendActivity
          id: sendActivity_tired
          activity: Let's try again later...
