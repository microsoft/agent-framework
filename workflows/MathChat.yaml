kind: AdaptiveDialog
beginDialog:

  kind: OnActivity
  id: workflow_demo
  actions:

    - kind: SetVariable
      id: set_project
      variable: Topic.Project
      value: =System.LastMessage.Text

    - kind: SetVariable # // %%% HAXX
      id: set_count_0
      variable: Topic.TurnCount
      value: 0

    - kind: AnswerQuestionWithAI
      id: asst_jCrWfBd1XrfVXMtpbfyVoIHC # // %%% HAXX
      displayName: Student
      userInput: =Topic.Project

    # - kind: ResetVariable
    #   id: reset_project
    #   variable: Topic.Project

    - kind: SetVariable # // %%% HAXX
      id: reset_project
      variable: Topic.Project
      value: =Blank()

    - kind: AnswerQuestionWithAI
      id: asst_aArB2g4tFWOTcgmUua062wjM # // %%% HAXX
      displayName: Teacher
      userInput: ="" # // %%% HAXX

    - kind: SetVariable
      id: set_count_increment
      variable: Topic.TurnCount
      value: =Topic.TurnCount + 1

    - kind: ConditionGroup
      id: check_completion
      conditions:

        - condition: =!IsBlank(Find("congratulations", Lower(System.LastMessage.Text)))
          id: check_turn_done
          actions:

            - kind: SendActivity
              id: sendActivity_done
              activity: GOLD STAR!
    
        - condition: =Topic.TurnCount < 8
          id: check_turn_count
          actions:
    
            - kind: GotoAction
              id: goto_student_agent
              actionId: asst_jCrWfBd1XrfVXMtpbfyVoIHC

      elseActions:
    
        - kind: SendActivity
          id: sendActivity_tired
          activity: Let's try again later...
